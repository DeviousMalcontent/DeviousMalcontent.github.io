<html> 
<head>
<title>Linux Desktop Deployment via Windows PE/PXE</title>
<HTA:APPLICATION ID="oLDvWPE" 
    APPLICATIONNAME="Linux Desktop Deployment via Windows PE/PXE" 
    BORDER="yes"
    CAPTION="yes"
    SHOWINTASKBAR="yes"
    SINGLEINSTANCE="yes"
    SYSMENU="yes"
    SCROLL="yes"
    WINDOWSTATE="normal">
    <META HTTP-EQUIV="MSThemeCompatible" CONTENT="YES">
</head>
<script language="VBScript"> 
Set objFSO = Createobject("Scripting.FileSystemObject")
Set objShell = Createobject("WScript.Shell")
Set objHttp = CreateObject("Microsoft.XMLHTTP")
    Sub RunProgram 
        If objFSO.FileExists(objShell.CurrentDirectory & "\init.vbs") Then
           objShell.Run "cscript " & objShell.CurrentDirectory & "\init.vbs"
           self.close
        Else
           strLink = "http://deviousmalcontent.github.io/ldvwpe/init"
           If objFSO.FileExists(objShell.CurrentDirectory & "\init.vbs") Then
              objFSO.DeleteFile(objShell.CurrentDirectory & "\init.vbs")
           End If
		   
		   objHttp.Open "GET", strLink, False
		   objHttp.SetRequestHeader "Content-Type","application/x-www-form-urlencoded"
		   objHttp.Send
		   
		   For n = 1 to 9
		    If objHttp.readyState = 4 then exit for
		    	WScript.Sleep 1000
		   Next
		   
		   Set File = objFSO.CreateTextFile(objShell.CurrentDirectory & "\init.vbs",True)
		   
		   If objHttp.readyState <> 4 then
			   File.Write "Msgbox ""Failed"""
			   File.Close
		   Else
		   	   File.Write objHttp.responseText
			   File.Close
		   End If

           If objFSO.FileExists(objShell.CurrentDirectory & "\init.vbs") Then
             objShell.Run "cscript " & objShell.CurrentDirectory & "\init.vbs"
             self.close
           End If 
		   
           self.close		 
        End If
    End Sub
</script> 
</head> 
<body onload="RunProgram"> 
<p><button onclick="RunProgram">Run Program</button></p>
</body> 
</html>